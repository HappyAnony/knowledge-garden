/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
If you want to view the source, please visit the github repository of this plugin
*/

var x=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var b=Object.prototype.hasOwnProperty;var H=(c,e)=>{for(var t in e)x(c,t,{get:e[t],enumerable:!0})},W=(c,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of k(e))!b.call(c,i)&&i!==t&&x(c,i,{get:()=>e[i],enumerable:!(s=y(e,i))||s.enumerable});return c};var G=c=>W(x({},"__esModule",{value:!0}),c);var V={};H(V,{default:()=>N});module.exports=G(V);var _=require("obsidian");var u=require("obsidian");var w=class{constructor(e){this.app=e}async searchFolders(e){if(!e)return[];let s=this.app.vault.getAllFolders().map(i=>i.path==="/"?"/":i.path.startsWith("/")?i.path:"/"+i.path);return s=s.filter(i=>i.toLowerCase().includes(e.toLowerCase())).sort(),s}displayFolderSuggestions(e){if(document.querySelectorAll(".folder-suggestions-container").forEach(l=>l.remove()),e.length===0)return;let s=document.activeElement;if(!(s instanceof HTMLInputElement))return;let i=s.closest(".setting-item-control");if(!i)return;i.style.position="relative",console.log("Setting up suggestions container with parent:",i);let n=document.createElement("div");n.className="folder-suggestions-container",e.forEach(l=>{let d=document.createElement("div");d.className="folder-suggestion-item",d.textContent=l,d.addEventListener("click",()=>{s.value=l;let g=new Event("input",{bubbles:!0});s.dispatchEvent(g),n.remove()}),n.appendChild(d)});let o=s.getBoundingClientRect();i.appendChild(n),n.style.top=`${o.height+4}px`,n.style.width=`${o.width}px`,n.offsetHeight,console.log("Container styles after positioning:",{position:n.style.position,right:n.style.right,left:n.style.left,top:n.style.top,width:n.style.width});let r=l=>{!n.contains(l.target)&&l.target!==s&&(n.remove(),document.removeEventListener("click",r))};setTimeout(()=>{document.addEventListener("click",r)},0)}};var F={defaultSortMode:"name",defaultFilterMode:1,excludedTags:"",defaultGroupState:"expanded",showMatchedTags:!1,excludedFolders:[]},f=class extends u.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t,this.folderSuggestions=new w(e)}display(){let{containerEl:e}=this;e.empty(),new u.Setting(e).setName("Default sort mode").setDesc("Default sort method for related notes").addDropdown(i=>i.addOption("name","Name").addOption("date","Date Edited").addOption("created","Date Created").setValue(this.plugin.settings.defaultSortMode).onChange(async n=>{this.plugin.settings.defaultSortMode=n,await this.plugin.saveSettings()})),new u.Setting(e).setName("Excluded tags").setDesc("Comma-separated list of tags to exclude from related notes (# prefix optional)").addText(i=>i.setPlaceholder("e.g., ignore, draft, #private").setValue(this.plugin.settings.excludedTags).onChange(async n=>{this.plugin.settings.excludedTags=n,await this.plugin.saveSettings()})),new u.Setting(e).setName("Default group state").setDesc("Initial expansion state of tag groups").addDropdown(i=>i.addOption("collapsed","Collapsed").addOption("expanded","Expanded").setValue(this.plugin.settings.defaultGroupState).onChange(async n=>{this.plugin.settings.defaultGroupState=n,await this.plugin.saveSettings()})),e.createEl("h3",{text:"Folder Exclusion"}),e.createEl("p",{text:"Exclude files from specific folders when finding related notes. Use absolute paths from vault root (e.g., /Personal/Journal).",cls:"setting-item-description"});let t=e.createDiv("folder-exclusion-container");this.renderFolderExclusions(t),new u.Setting(e).setName("Add another exclusion").setDesc("Add a new folder to exclude from related notes").addButton(i=>i.setIcon("folder-plus").setTooltip("Add another folder exclusion").setCta().onClick(()=>{this.addNewFolderExclusion(t)})),e.createEl("h3",{text:"Activation and usage instructions"});let s=e.createDiv("related-notes-instructions");s.createEl("p",{text:"To activate the Related Notes by Tag sidebar:"}),s.createEl("ul",{},i=>{i.createEl("li",{text:"Click the ribbon icon (tag icon) in the top right if visible"}),i.createEl("li",{text:'Or use the command palette: "Related Notes by Tag: Open sidebar"'})}),s.createEl("p",{text:"Usage:"}),s.createEl("ul",{},i=>{i.createEl("li",{text:"Click tag group header to expand/collapse group"}),i.createEl("li",{text:"Click note name to open in current tab"}),i.createEl("li",{text:"Cmd/ctrl-click note name to open note in a new tab"}),i.createEl("li",{text:"Click Name/Date to change sort order"})})}renderFolderExclusions(e){if(e.empty(),this.plugin.settings.excludedFolders.length===0){e.createEl("p",{text:'No folders excluded yet. Click "Add Folder Path" to create one.',cls:"setting-item-description"});return}this.plugin.settings.excludedFolders.forEach((t,s)=>{let i=new u.Setting(e),n=()=>{let o=t.includeChildren?" (selected folder plus subfolders)":" (selected folder only)";i.descEl.empty(),i.descEl.createSpan({text:`${s+1}: ${t.path||"(empty)"}${o}`,cls:"setting-item-description"})};i.addText(o=>(o.setPlaceholder("/path/to/folder").setValue(t.path).onChange(async r=>{this.plugin.settings.excludedFolders[s].path=r,await this.plugin.saveSettings(),n()}),o.inputEl.addEventListener("input",async()=>{let r=await this.folderSuggestions.searchFolders(o.getValue());this.folderSuggestions.displayFolderSuggestions(r)}),o)).addToggle(o=>o.setTooltip("Include subfolders").setValue(t.includeChildren).onChange(async r=>{this.plugin.settings.excludedFolders[s].includeChildren=r,await this.plugin.saveSettings(),n()})).addButton(o=>(o.setIcon("trash-2").setTooltip("Delete folder exclusion").onClick(async()=>{this.plugin.settings.excludedFolders.splice(s,1),await this.plugin.saveSettings(),this.renderFolderExclusions(e)}),o.buttonEl.addClass("folder-exclusion-delete-btn"),o)),n()})}addNewFolderExclusion(e){let t={path:"",includeChildren:!0,id:Date.now().toString()};this.plugin.settings.excludedFolders.push(t),this.plugin.saveSettings(),this.renderFolderExclusions(e)}};var P=require("obsidian");var I=require("obsidian"),S=class{constructor(e){this.app=e}analyzeRelatedNotes(e,t){let s=this.app.metadataCache.getFileCache(e);if(!s)return{relatedNotesMap:new Map,currentNoteTags:[]};let i=(0,I.getAllTags)(s);if(!i||i.length===0)return{relatedNotesMap:new Map,currentNoteTags:[]};let n=this.getFilteredTags(i,t.excludedTags);return{relatedNotesMap:this.findRelatedNotes(e,n,t.defaultFilterMode,t),currentNoteTags:n}}getFilteredTags(e,t){let s=t.split(",").map(i=>{let n=i.trim().toLowerCase();return n.startsWith("#")?n:`#${n}`}).filter(i=>i.length>1);return[...new Set(e)].filter(i=>!s.includes(i.toLowerCase()))}findRelatedNotes(e,t,s,i){let n=new Map,o=this.app.vault.getMarkdownFiles();for(let r of o){if(r.path===e.path||this.isFileInExcludedFolder(r,i))continue;let l=this.getOverlappingTags(r,t);if(l.length>=s){let d={file:r,matchedTags:l};l.forEach(g=>{var m;n.has(g)||n.set(g,[]),(m=n.get(g))==null||m.push(d)})}}return n}getOverlappingTags(e,t){let s=this.app.metadataCache.getFileCache(e);if(!s)return[];let i=(0,I.getAllTags)(s);if(!i)return[];let n=[...new Set(i)];return t.filter(o=>n.includes(o))}sortFiles(e,t){let s=[...e];switch(t){case"date":return s.sort((i,n)=>n.file.stat.mtime-i.file.stat.mtime);case"created":return s.sort((i,n)=>n.file.stat.ctime-i.file.stat.ctime);default:return s.sort((i,n)=>i.file.basename.localeCompare(n.file.basename))}}isFileInExcludedFolder(e,t){let s=e.path;return t.excludedFolders.some(i=>{let n=this.normalizePath(i.path),o=this.normalizePath(s);return i.includeChildren?o.startsWith(n+"/")||o===n:o.substring(0,o.lastIndexOf("/"))===n})}normalizePath(e){return e.replace(/^\/+|\/+$/g,"").replace(/\/+/g,"/")}};var v=require("obsidian");var D={SORT:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="m3 8 4-4 4 4"/><path d="M7 4v16"/><path d="M11 12h4"/><path d="M11 16h7"/><path d="M11 20h10"/></svg>',FILTER:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M22 3H2l8 9.46V19l4 2v-8.54L22 3z"/></svg>',TAGS_TOGGLE:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M9 5H2v7l6.29 6.29c.94.94 2.48.94 3.42 0l3.58-3.58c.94-.94.94-2.48 0-3.42L9 5Z"/><path d="M6 9.01V9"/><path d="m15 5 6.3 6.3a2.69 2.69 0 0 1 0 3.79L17.5 19a2.69 2.69 0 0 1-3.79 0L10 15.21"/></svg>',DROPDOWN_CARET:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="m6 9 6 6 6-6"/></svg>',RELATED_NOTES:'<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tags"><path d="M9 5H2v7l6.29 6.29c.94.94 2.48.94 3.42 0l3.58-3.58c.94-.94.94-2.48 0-3.42L9 5Z"/><path d="M6 9.01V9"/><path d="m15 5 6.3 6.3a2.69 2.69 0 0 1 0 3.79L17.5 19a2.69 2.69 0 0 1-3.79 0L10 15.21"/></svg>'},a={CONTAINER:"related-notes-container",HEADER:"related-notes-header",ACTION_BUTTONS:"action-buttons",SORT_CONTROLS:"sort-controls",FILTER_CONTROLS:"filter-controls",TAGS_TOGGLE_CONTROLS:"tags-toggle-controls",DROPDOWN_CONTAINER:"dropdown-container",DROPDOWN_TRIGGER:"dropdown-trigger",DROPDOWN_MENU:"dropdown-menu",DROPDOWN_ITEM:"dropdown-item",DROPDOWN_ITEM_ACTIVE:"is-active",DROPDOWN_VISIBLE:"is-visible",TAG_GROUP:"related-notes-tag-group",TAG_GROUP_HEADER:"related-notes-tag-group-header",NOTES_LIST:"related-notes-list",LIST_ITEM:"related-notes-list-item",NOTE_LINK:"related-note-link",MATCHED_TAGS:"matched-tags",MATCHED_TAG:"matched-tag",SEPARATOR:"related-notes-separator",PREVIEW:"related-notes-preview",PREVIEW_LOADED:"is-loaded",INSTRUCTIONS:"related-notes-instructions"},M={VIEW_UPDATE_DELAY:50,PREVIEW_RENDER_DELAY:150},T={PREVIEW_POPUP_WIDTH:400,PREVIEW_POPUP_MARGIN:10,PREVIEW_MAX_HEIGHT:"40vh"},p={NAME:"name",DATE:"date",CREATED:"created"},h={ONE_TAG:1,TWO_TAGS:2,THREE_TAGS:3};var O={[p.NAME]:"Name",[p.DATE]:"Modified Date",[p.CREATED]:"Created Date"},L={[h.ONE_TAG]:"Match at least 1 tag",[h.TWO_TAGS]:"Match at least 2 tags",[h.THREE_TAGS]:"Match at least 3 tags"};var R=class extends v.Component{constructor(t){super();this.app=t;this.previewPopup=null;this.currentPreviewFile=null;this.isModifierHeld=!1;this.lastMousePosition={x:0,y:0};this.trackMousePosition=t=>{this.lastMousePosition={x:t.clientX,y:t.clientY}};this.handleKeyDown=t=>{if(this.isModifierHeld=t.metaKey||t.ctrlKey,this.isModifierHeld){let s=document.elementFromPoint(this.lastMousePosition.x,this.lastMousePosition.y),i=s==null?void 0:s.closest(`.${a.NOTE_LINK}`);if(i instanceof HTMLElement&&i.dataset.filePath){let n=this.app.vault.getAbstractFileByPath(i.dataset.filePath);n instanceof v.TFile&&this.showPreview(n,i)}}};this.handleKeyUp=t=>{(t.key==="Meta"||t.key==="Control")&&(this.isModifierHeld=!1,this.previewPopup&&this.hidePreview())};this.hidePreviewOnClick=()=>{this.hidePreview()};this.setupEventListeners()}setupEventListeners(){document.addEventListener("mousemove",this.trackMousePosition),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}cleanup(){document.removeEventListener("mousemove",this.trackMousePosition),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp),this.hidePreview(),this.unload()}showPreview(t,s){this.hidePreview(),this.previewPopup=document.body.createDiv(a.PREVIEW),this.currentPreviewFile=t;let i=this.calculatePosition(s);this.applyPopupStyles(i),document.addEventListener("click",this.hidePreviewOnClick,{once:!0}),this.renderPreviewContent(t)}calculatePosition(t){let s=t.getBoundingClientRect(),i=window.innerWidth,n=T.PREVIEW_POPUP_WIDTH,o=T.PREVIEW_POPUP_MARGIN,r;return s.right+n+o<=i?r=s.right+o:s.left-n-o>=0?r=s.left-n-o:r=Math.max(o,Math.min((i-n)/2,i-n-o)),{left:r,top:s.top}}applyPopupStyles(t){this.previewPopup&&Object.assign(this.previewPopup.style,{position:"fixed",left:`${t.left}px`,top:`${t.top}px`,zIndex:"9999",width:`${T.PREVIEW_POPUP_WIDTH}px`,maxHeight:T.PREVIEW_MAX_HEIGHT,overflowY:"auto"})}renderPreviewContent(t){setTimeout(async()=>{var s;if(this.previewPopup&&this.currentPreviewFile===t&&this.isModifierHeld)try{let i=await this.app.vault.read(t);await v.MarkdownRenderer.render(this.app,i,this.previewPopup,t.path,this),(s=this.previewPopup)==null||s.addClass(a.PREVIEW_LOADED)}catch(i){console.error("Failed to render preview:",i),this.previewPopup&&this.previewPopup.setText("Failed to load preview")}},M.PREVIEW_RENDER_DELAY)}hidePreview(){this.previewPopup&&(this.previewPopup.remove(),this.previewPopup=null,this.currentPreviewFile=null)}getIsModifierHeld(){return this.isModifierHeld}};var A=class{constructor(){this.openDropdowns=new Set;this.handleGlobalClick=e=>{let t=e.target,s=!1;for(let i of this.openDropdowns)if(i.contains(t)){s=!0;break}s||this.closeAllDropdowns()};document.addEventListener("click",this.handleGlobalClick)}closeAllDropdowns(){this.openDropdowns.forEach(e=>{let t=e.querySelector(`.${a.DROPDOWN_MENU}`);t&&t.classList.remove(a.DROPDOWN_VISIBLE)})}createDropdown(e,t){let s=e.createDiv(a.DROPDOWN_CONTAINER);t.containerClass&&s.addClass(t.containerClass);let i=s.createEl("button",{cls:`${a.DROPDOWN_TRIGGER} clickable-icon`}),r=new DOMParser().parseFromString(t.icon,"image/svg+xml").documentElement;i.appendChild(r);let l=s.createDiv(a.DROPDOWN_MENU);return t.options.forEach(d=>{let g=l.createEl("div",{cls:`${a.DROPDOWN_ITEM} ${d.isActive?a.DROPDOWN_ITEM_ACTIVE:""}`,text:d.label});g.addEventListener("click",()=>{t.onItemClick(d.value),l.classList.remove(a.DROPDOWN_VISIBLE),l.querySelectorAll(`.${a.DROPDOWN_ITEM}`).forEach(m=>m.classList.remove(a.DROPDOWN_ITEM_ACTIVE)),g.classList.add(a.DROPDOWN_ITEM_ACTIVE)})}),i.addEventListener("click",d=>{d.stopPropagation(),this.closeAllDropdowns(),l.classList.toggle(a.DROPDOWN_VISIBLE),l.classList.contains(a.DROPDOWN_VISIBLE)?this.openDropdowns.add(s):this.openDropdowns.delete(s)}),s}createSortDropdown(e,t,s){let i=[{value:p.NAME,label:O[p.NAME],isActive:t===p.NAME},{value:p.DATE,label:O[p.DATE],isActive:t===p.DATE},{value:p.CREATED,label:O[p.CREATED],isActive:t===p.CREATED}];return this.createDropdown(e,{icon:D.SORT,options:i,onItemClick:n=>s(n),containerClass:a.SORT_CONTROLS})}createFilterDropdown(e,t,s){let i=[{value:h.ONE_TAG,label:L[h.ONE_TAG],isActive:t===h.ONE_TAG},{value:h.TWO_TAGS,label:L[h.TWO_TAGS],isActive:t===h.TWO_TAGS},{value:h.THREE_TAGS,label:L[h.THREE_TAGS],isActive:t===h.THREE_TAGS}];return this.createDropdown(e,{icon:D.FILTER,options:i,onItemClick:n=>s(n),containerClass:a.FILTER_CONTROLS})}createHeader(e){return e.createDiv(a.HEADER)}createActionButtonsContainer(e){return e.createDiv(a.ACTION_BUTTONS)}createTagsToggleButton(e,t,s){let i=e.createEl("button",{cls:`${a.DROPDOWN_TRIGGER} ${a.TAGS_TOGGLE_CONTROLS} clickable-icon ${t?a.DROPDOWN_ITEM_ACTIVE:""}`,title:t?"Hide matched tags":"Show matched tags"}),r=new DOMParser().parseFromString(D.TAGS_TOGGLE,"image/svg+xml").documentElement;return i.appendChild(r),i.addEventListener("click",l=>{l.stopPropagation(),this.closeAllDropdowns();let d=!t;s(d),d?(i.addClass(a.DROPDOWN_ITEM_ACTIVE),i.title="Hide matched tags"):(i.removeClass(a.DROPDOWN_ITEM_ACTIVE),i.title="Show matched tags")}),i}cleanup(){document.removeEventListener("click",this.handleGlobalClick),this.openDropdowns.clear()}};var E="related-notes-by-tag-view",C=class extends P.ItemView{async handleSortChange(e){this.plugin.settings.defaultSortMode=e,await this.plugin.saveSettings(),this.updateView()}async handleFilterChange(e){this.plugin.settings.defaultFilterMode=e,await this.plugin.saveSettings(),this.updateView()}async handleTagsToggle(e){this.plugin.settings.showMatchedTags=e,await this.plugin.saveSettings(),this.updateView()}constructor(e,t){super(e),this.plugin=t,this.tagAnalyzer=new S(this.app),this.previewManager=new R(this.app),this.uiRenderer=new A}getViewType(){return E}getDisplayText(){return"Related notes by tag"}getIcon(){return"tag"}async onOpen(){this.container=this.contentEl,this.container.empty(),this.container.addClass(a.CONTAINER),this.updateView()}async onClose(){this.previewManager.cleanup(),this.uiRenderer.cleanup(),this.container.empty()}async updateView(){if(!this.plugin.app.workspace.layoutReady)return;this.container.empty(),this.container.addClass(a.CONTAINER);let e=this.renderHeader();this.renderControls(e);let t=this.getActiveFile();if(!t)return;let s=this.tagAnalyzer.analyzeRelatedNotes(t,this.plugin.settings);if(s.currentNoteTags.length===0){this.container.createEl("p",{text:"Active note has no tags."});return}if(s.relatedNotesMap.size===0){this.container.createEl("p",{text:"No other notes found with matching tags."});return}this.renderTagGroups(s.relatedNotesMap)}renderHeader(){return this.uiRenderer.createHeader(this.container)}renderControls(e){let t=this.uiRenderer.createActionButtonsContainer(e);this.uiRenderer.createSortDropdown(t,this.plugin.settings.defaultSortMode,s=>this.handleSortChange(s)),this.uiRenderer.createFilterDropdown(t,this.plugin.settings.defaultFilterMode,s=>this.handleFilterChange(s)),this.uiRenderer.createTagsToggleButton(t,this.plugin.settings.showMatchedTags,s=>this.handleTagsToggle(s))}getActiveFile(){let e=this.app.workspace.getActiveFile();return!e||!(e instanceof P.TFile)?(this.container.createEl("p",{text:"No active note or not a markdown file."}),null):e}renderTagGroups(e){e.forEach((t,s)=>{let i=this.container.createDiv({cls:`${a.TAG_GROUP} ${this.plugin.settings.defaultGroupState}`}),n=i.createEl("div",{text:`Notes with tag: ${s}`,cls:a.TAG_GROUP_HEADER}),o=i.createEl("ul",{cls:a.NOTES_LIST});this.setupTagGroupToggle(i,n);let r=this.tagAnalyzer.sortFiles(t,this.plugin.settings.defaultSortMode);this.renderFileList(o,r),i.createEl("hr",{cls:a.SEPARATOR})})}setupTagGroupToggle(e,t){t.addEventListener("click",()=>{e.toggleClass("collapsed",!e.hasClass("collapsed"))})}renderFileList(e,t){t.forEach(s=>{let i=e.createEl("li",{cls:a.LIST_ITEM}),n=this.createFileLink(i,s.file);this.setupFileLinkEvents(n,s.file),this.plugin.settings.showMatchedTags&&this.renderMatchedTags(i,s.matchedTags)})}createFileLink(e,t){let s=e.createEl("a",{text:t.basename,href:"#",title:`Hold Cmd/Ctrl + hover to preview
Click to open`,cls:a.NOTE_LINK});return s.dataset.filePath=t.path,s}setupFileLinkEvents(e,t){let s;e.addEventListener("mouseenter",i=>{i.metaKey||i.ctrlKey?this.previewManager.showPreview(t,e):s=setTimeout(()=>{e.matches(":hover")&&this.previewManager.getIsModifierHeld()&&this.previewManager.showPreview(t,e)},100)}),e.addEventListener("mouseleave",()=>{s&&clearTimeout(s),this.previewManager.getIsModifierHeld()||this.previewManager.hidePreview()}),e.addEventListener("click",i=>{i.preventDefault(),i.ctrlKey||i.metaKey?this.app.workspace.getLeaf("tab").openFile(t,{active:!0}):this.app.workspace.getLeaf().openFile(t,{active:!0})})}renderMatchedTags(e,t){let s=e.createDiv(a.MATCHED_TAGS);t.forEach(i=>{s.createSpan({text:i,cls:a.MATCHED_TAG})})}};var N=class extends _.Plugin{async onload(){await this.loadSettings(),this.registerView(E,e=>new C(e,this)),this.addCommand({id:"open-related-notes-panel",name:"Open sidebar",callback:()=>{this.activateView()}}),this.addSettingTab(new f(this.app,this)),this.registerEvent(this.app.workspace.on("active-leaf-change",e=>{let t=this.getView();t&&e&&t.leaf!==e&&e.view.getViewType()==="markdown"&&setTimeout(async()=>{let s=this.getView();s&&await s.updateView()},M.VIEW_UPDATE_DELAY)})),this.registerEvent(this.app.metadataCache.on("changed",async e=>{var s;let t=this.getView();t&&((s=this.app.workspace.getActiveFile())==null?void 0:s.path)===e.path&&await t.updateView()})),this.app.workspace.onLayoutReady(()=>{this.initializePanelInSidebar()})}onunload(){}getView(){let e=this.app.workspace.getLeavesOfType(E);return e.length>0?e[0].view:null}async loadSettings(){this.settings=Object.assign({},F,await this.loadData())}async saveSettings(){await this.saveData(this.settings);let e=this.getView();e&&await e.updateView()}async initializePanelInSidebar(){if(this.app.workspace.getLeavesOfType(E).length>0)return;let t=this.app.workspace.getRightLeaf(!1);t&&await t.setViewState({type:E,active:!1})}async activateView(){let e=this.app.workspace.getLeavesOfType(E);if(e.length>0){this.app.workspace.revealLeaf(e[0]);return}let t=this.app.workspace.getRightLeaf(!1);t||(t=this.app.workspace.getRightLeaf(!0)),t?(await t.setViewState({type:E,active:!0}),this.app.workspace.revealLeaf(t)):new _.Notice("Could not Open Related Notes by Tag sidebar: No available leaf.")}};

/* nosourcemap */